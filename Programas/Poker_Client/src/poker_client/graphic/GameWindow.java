package poker_client.graphic;

import entities.Card;
import entities.Player;
import java.awt.Graphics;
import java.awt.Image;
import java.awt.Toolkit;
import javax.swing.JLabel;
import javax.swing.JOptionPane;
import javax.swing.JPanel;


public class GameWindow extends javax.swing.JFrame {
    private final Player PLAYER;
//    private static final Jugador JUGADOR = new Jugador();
    
    /**
     * Creates new form WindowJugador
     */
    public GameWindow(Player player) {
        initComponents();
        PLAYER = player;
        
        this.setLocationRelativeTo(null);
        this.setVisible(true);
    }
    
    /**
     * This method is called from within the constructor to initialize the form.
     * WARNING: Do NOT modify this code. The content of this method is always
     * regenerated by the Form Editor.
     */
    @SuppressWarnings("unchecked")
    // <editor-fold defaultstate="collapsed" desc="Generated Code">//GEN-BEGIN:initComponents
    private void initComponents() {

        jPanelPrincipal = new JPanel() {
            public void paintComponent(Graphics g) {
                Image img = Toolkit.getDefaultToolkit().getImage(
                    WindowJugador.class.getResource("/imagenes/game_menu_background2.jpg"));
                g.drawImage(img, 0, 0, this.getWidth(), this.getHeight(), this);
            }
        };
        jButton1 = new javax.swing.JButton();
        jButton2 = new javax.swing.JButton();
        jButton3 = new javax.swing.JButton();
        jButton4 = new javax.swing.JButton();
        jButtonBet = new javax.swing.JButton();
        jTextFieldBetAmmount = new javax.swing.JTextField();
        jLabelPoolComun = new javax.swing.JLabel();
        jLabel3 = new javax.swing.JLabel();
        jLabelIDPlayer = new javax.swing.JLabel();
        jButtonRetire = new javax.swing.JButton();
        jLabel5 = new javax.swing.JLabel();
        jLabelPlayerInfoTitle = new javax.swing.JLabel();
        jLabelOwnChips = new javax.swing.JLabel();
        jLabel11 = new javax.swing.JLabel();
        jLabel9 = new javax.swing.JLabel();
        jLabelConnectionStatus = new javax.swing.JLabel();
        jLabelCartaMesa1 = new javax.swing.JLabel();
        jLabelCartaMesa2 = new javax.swing.JLabel();
        jLabelCartaMesa3 = new javax.swing.JLabel();
        jLabelCartaMesa4 = new javax.swing.JLabel();
        jLabelCartaMesa5 = new javax.swing.JLabel();
        jLabelCartaPropia1 = new javax.swing.JLabel();
        jLabelCartaPropia2 = new javax.swing.JLabel();
        jMenuBar1 = new javax.swing.JMenuBar();
        jMenuProperties = new javax.swing.JMenu();
        jMenuItemLeaveGame = new javax.swing.JMenuItem();
        jMenuItemExit = new javax.swing.JMenuItem();
        jMenuLeyend = new javax.swing.JMenu();

        setDefaultCloseOperation(javax.swing.WindowConstants.DO_NOTHING_ON_CLOSE);
        setTitle("Game Window");
        setIconImage(Toolkit.getDefaultToolkit().getImage(getClass().getResource("/imagenes/icon.png")));

        jPanelPrincipal.setLayout(new org.netbeans.lib.awtextra.AbsoluteLayout());

        jButton1.setText("Enviar");
        jButton1.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jButton1ActionPerformed(evt);
            }
        });
        jPanelPrincipal.add(jButton1, new org.netbeans.lib.awtextra.AbsoluteConstraints(230, 280, 127, 32));

        jButton2.setText("Get Ganador");
        jButton2.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jButton2ActionPerformed(evt);
            }
        });
        jPanelPrincipal.add(jButton2, new org.netbeans.lib.awtextra.AbsoluteConstraints(230, 320, 113, 32));

        jButton3.setText("Destapar Propias");
        jButton3.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jButton3ActionPerformed(evt);
            }
        });
        jPanelPrincipal.add(jButton3, new org.netbeans.lib.awtextra.AbsoluteConstraints(230, 200, -1, 32));

        jButton4.setText("Destapar Comunes");
        jButton4.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jButton4ActionPerformed(evt);
            }
        });
        jPanelPrincipal.add(jButton4, new org.netbeans.lib.awtextra.AbsoluteConstraints(230, 240, -1, 32));

        jButtonBet.setText("Bet");
        jButtonBet.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jButtonBetActionPerformed(evt);
            }
        });
        jPanelPrincipal.add(jButtonBet, new org.netbeans.lib.awtextra.AbsoluteConstraints(590, 410, 80, 32));

        jTextFieldBetAmmount.setText("50");
        jTextFieldBetAmmount.setToolTipText("");
        jPanelPrincipal.add(jTextFieldBetAmmount, new org.netbeans.lib.awtextra.AbsoluteConstraints(590, 380, 80, -1));

        jLabelPoolComun.setFont(new java.awt.Font("sansserif", 1, 18)); // NOI18N
        jLabelPoolComun.setForeground(new java.awt.Color(255, 255, 255));
        jLabelPoolComun.setText("<html><b>Common Pool</b></html>");
        jPanelPrincipal.add(jLabelPoolComun, new org.netbeans.lib.awtextra.AbsoluteConstraints(370, 40, -1, 31));

        jLabel3.setForeground(new java.awt.Color(255, 255, 255));
        jLabel3.setIcon(new javax.swing.ImageIcon(getClass().getResource("/imagenes/user.png"))); // NOI18N
        jPanelPrincipal.add(jLabel3, new org.netbeans.lib.awtextra.AbsoluteConstraints(6, 28, 30, 30));

        jLabelIDPlayer.setForeground(new java.awt.Color(255, 255, 255));
        jLabelIDPlayer.setText("ID");
        jPanelPrincipal.add(jLabelIDPlayer, new org.netbeans.lib.awtextra.AbsoluteConstraints(50, 30, 20, 26));

        jButtonRetire.setIcon(new javax.swing.ImageIcon(getClass().getResource("/imagenes/chicken2.png"))); // NOI18N
        jButtonRetire.setText("Retire");
        jButtonRetire.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jButtonRetireActionPerformed(evt);
            }
        });
        jPanelPrincipal.add(jButtonRetire, new org.netbeans.lib.awtextra.AbsoluteConstraints(677, 409, -1, -1));

        jLabel5.setForeground(new java.awt.Color(255, 255, 255));
        jLabel5.setText("Connection");
        jPanelPrincipal.add(jLabel5, new org.netbeans.lib.awtextra.AbsoluteConstraints(690, 30, -1, -1));

        jLabelPlayerInfoTitle.setForeground(new java.awt.Color(255, 255, 255));
        jLabelPlayerInfoTitle.setText("<html><u>Player's Info</u></html>");
        jPanelPrincipal.add(jLabelPlayerInfoTitle, new org.netbeans.lib.awtextra.AbsoluteConstraints(6, 6, -1, -1));

        jLabelOwnChips.setForeground(new java.awt.Color(255, 255, 255));
        jLabelOwnChips.setText("#Chips");
        jPanelPrincipal.add(jLabelOwnChips, new org.netbeans.lib.awtextra.AbsoluteConstraints(50, 60, -1, 31));

        jLabel11.setIcon(new javax.swing.ImageIcon(getClass().getResource("/imagenes/chip.png"))); // NOI18N
        jPanelPrincipal.add(jLabel11, new org.netbeans.lib.awtextra.AbsoluteConstraints(320, 30, 41, 57));

        jLabel9.setForeground(new java.awt.Color(255, 255, 255));
        jLabel9.setIcon(new javax.swing.ImageIcon(getClass().getResource("/imagenes/chip2.png"))); // NOI18N
        jPanelPrincipal.add(jLabel9, new org.netbeans.lib.awtextra.AbsoluteConstraints(10, 60, 30, 30));

        jLabelConnectionStatus.setIcon(new javax.swing.ImageIcon(getClass().getResource("/imagenes/cross.png"))); // NOI18N
        jPanelPrincipal.add(jLabelConnectionStatus, new org.netbeans.lib.awtextra.AbsoluteConstraints(760, 10, 40, 47));

        jLabelCartaMesa1.setIcon(new javax.swing.ImageIcon(getClass().getResource("/imagenes/card_back.png"))); // NOI18N
        jPanelPrincipal.add(jLabelCartaMesa1, new org.netbeans.lib.awtextra.AbsoluteConstraints(112, 182, -1, 80));

        jLabelCartaMesa2.setIcon(new javax.swing.ImageIcon(getClass().getResource("/imagenes/card_back.png"))); // NOI18N
        jPanelPrincipal.add(jLabelCartaMesa2, new org.netbeans.lib.awtextra.AbsoluteConstraints(233, 182, -1, 80));

        jLabelCartaMesa3.setIcon(new javax.swing.ImageIcon(getClass().getResource("/imagenes/card_back.png"))); // NOI18N
        jPanelPrincipal.add(jLabelCartaMesa3, new org.netbeans.lib.awtextra.AbsoluteConstraints(370, 180, -1, 80));

        jLabelCartaMesa4.setIcon(new javax.swing.ImageIcon(getClass().getResource("/imagenes/card_back.png"))); // NOI18N
        jPanelPrincipal.add(jLabelCartaMesa4, new org.netbeans.lib.awtextra.AbsoluteConstraints(502, 182, -1, 80));

        jLabelCartaMesa5.setIcon(new javax.swing.ImageIcon(getClass().getResource("/imagenes/card_back.png"))); // NOI18N
        jPanelPrincipal.add(jLabelCartaMesa5, new org.netbeans.lib.awtextra.AbsoluteConstraints(626, 182, -1, 80));

        jLabelCartaPropia1.setIcon(new javax.swing.ImageIcon(getClass().getResource("/imagenes/card_back.png"))); // NOI18N
        jPanelPrincipal.add(jLabelCartaPropia1, new org.netbeans.lib.awtextra.AbsoluteConstraints(305, 300, -1, 80));

        jLabelCartaPropia2.setIcon(new javax.swing.ImageIcon(getClass().getResource("/imagenes/card_back.png"))); // NOI18N
        jPanelPrincipal.add(jLabelCartaPropia2, new org.netbeans.lib.awtextra.AbsoluteConstraints(433, 300, -1, 80));

        jMenuProperties.setText("Properties");

        jMenuItemLeaveGame.setText("Leave Game");
        jMenuProperties.add(jMenuItemLeaveGame);

        jMenuItemExit.setText("Exit");
        jMenuItemExit.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jMenuItemExitActionPerformed(evt);
            }
        });
        jMenuProperties.add(jMenuItemExit);

        jMenuBar1.add(jMenuProperties);

        jMenuLeyend.setText("Leyend");
        jMenuBar1.add(jMenuLeyend);

        setJMenuBar(jMenuBar1);

        javax.swing.GroupLayout layout = new javax.swing.GroupLayout(getContentPane());
        getContentPane().setLayout(layout);
        layout.setHorizontalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addComponent(jPanelPrincipal, javax.swing.GroupLayout.DEFAULT_SIZE, 820, Short.MAX_VALUE)
        );
        layout.setVerticalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addComponent(jPanelPrincipal, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
        );

        pack();
    }// </editor-fold>//GEN-END:initComponents
    
    /**
     * Obtencion de las cartas propias exclusivas del Jugador.
     */
    private void getCartasPropias() {
//        if(JUGADOR.getMano().getCartasPropias().isEmpty()) {
//            JUGADOR.obtenerCartasPersonales();
//            JUGADOR.verCartasPropias(); //fixme: Testeo. Sout Cartas. Borrar Cuando no sea necesario.
//        }else System.out.println("Ya tienes tus cartas.");
    }
    
    /**
     * Obtencion de las Cartas Comunes a todos.
     */
    private void getCartasComunes() {
//        JUGADOR.obtenerCartasComunes();
//        JUGADOR.verCartasComunes(); //fixme: Testeo. Sout Cartas. Borrar Cuando no sea necesario.
    }
    
    /**
     * Accion de apostar la cantidad que haya indicada.
     */
    private void apostar() {
//        int pool = JUGADOR.apostar(Integer.parseInt(jTextField1.getText()));
//
//        if(pool != -1) {
//            if(pool != -2) {
//                this.jLabelPoolComun.setText(Integer.toString(pool));
//                this.jLabelFichasPropias.setText(Integer.toString(JUGADOR.getFichas()));
//            } else  System.out.println("Obviamente no puedes apostar fichas que no tienes...");
//        } else System.out.println("No es momento de apostar.");
    }
    
    private void comprobarJugada() {
//        Jugadas.checkJugada(JUGADOR.getMano().getCartasPropias(), JUGADOR.getMano().getCartas_mesa());
//        String jugada = Jugadas.jugada;
//        this.jLabelJugadaPropia.setText(jugada);
    }
    
    private void destaparCarta(JLabel label, Card carta) {
//        String palo = carta.getPALO();
//        int valor = Jugadas.getValor(carta);
//        String nombreIMG = "../imagenes/" +palo +"/" +palo +valor +".png".trim();
//        System.out.println("Nombre de la imagen: " +nombreIMG);
//        label.setIcon(new javax.swing.ImageIcon(getClass().getResource(nombreIMG)));
    }
    
    private void destaparPropias() {
//        destaparCarta(jLabelCartaPropia1, JUGADOR.getMano().getCartasPropias().get(0));
//        destaparCarta(jLabelCartaPropia2, JUGADOR.getMano().getCartasPropias().get(1));
    }
    
    private void destaparComunes() {
//        int cartas = JUGADOR.getMano().getCartas_mesa().size();
//        System.out.println("Cartas Length: " +cartas);
//        if(cartas == 3) {
//            destaparCarta(jLabelCartaMesa1, JUGADOR.getMano().getCartas_mesa().get(0));
//            destaparCarta(jLabelCartaMesa2, JUGADOR.getMano().getCartas_mesa().get(1));
//            destaparCarta(jLabelCartaMesa3, JUGADOR.getMano().getCartas_mesa().get(2));
//        } else {
//            if(cartas == 4) destaparCarta(jLabelCartaMesa4, JUGADOR.getMano().getCartas_mesa().get(3));
//            else {
//                if(cartas == 5) destaparCarta(jLabelCartaMesa5, JUGADOR.getMano().getCartas_mesa().get(4));
//            }
//        }
    }
    
    private void taparCarta(JLabel label) {
//        String rutaIMG = "../imagenes/windows/juego/card_back.png";
//        label.setIcon(new javax.swing.ImageIcon(getClass().getResource(rutaIMG)));
    }
    
    private void cubrirCartas() {
//        taparCarta(jLabelCartaPropia1);
//        taparCarta(jLabelCartaPropia2);
//        taparCarta(jLabelCartaMesa1);
//        taparCarta(jLabelCartaMesa2);
//        taparCarta(jLabelCartaMesa3);
//        taparCarta(jLabelCartaMesa4);
//        taparCarta(jLabelCartaMesa5);
    }
    
    private void jButton3ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jButton3ActionPerformed
//        getCartasPropias();
//        comprobarJugada();
//        destaparPropias();
    }//GEN-LAST:event_jButton3ActionPerformed

    private void jButtonBetActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jButtonBetActionPerformed
//        apostar();
    }//GEN-LAST:event_jButtonBetActionPerformed

    private void jButton4ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jButton4ActionPerformed
//        getCartasComunes();
//        comprobarJugada();
//        destaparComunes();
    }//GEN-LAST:event_jButton4ActionPerformed

    private void jButton1ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jButton1ActionPerformed
//        JUGADOR.enviarJugada();
    }//GEN-LAST:event_jButton1ActionPerformed
   
    private void jButton2ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jButton2ActionPerformed
//        cubrirCartas();
//        int ganancias = JUGADOR.getWinner();
//        if(ganancias == -2) {
//            JOptionPane.showMessageDialog(this, "Te has quedado sin fichas y has sido eliminado.");
//            jButton1.setEnabled(false);
//            jButton2.setEnabled(false);
//            jButton3.setEnabled(false);
//            jButton4.setEnabled(false);
//            jButton5.setEnabled(false);
//            jButton6.setEnabled(false);
//            jTextField1.setEnabled(false);
//        }
//        else {
//            jLabelFichasPropias.setText(Integer.toString(ganancias));
//            jLabelPoolComun.setText("");
//            jLabelJugadaPropia.setText("");
//            JUGADOR.finRonda();
//        }
    }//GEN-LAST:event_jButton2ActionPerformed

    private void retirarse() {
//        boolean retirado = JUGADOR.retirarse();
//        if(retirado) {
//            System.out.println("Jugador retirado.");
//            jButton1.setEnabled(false);
//            jButton2.setEnabled(false);
//            jButton3.setEnabled(false);
//            jButton4.setEnabled(false);
//            jButton5.setEnabled(false);
//            jButton6.setEnabled(false);
//            jTextField1.setEnabled(false);
//        }
//        else System.out.println("Problemas al retirar al jugador.");
    }
    
    private void esperarFinRonda(java.awt.event.ActionEvent evt) {
//        jButton2ActionPerformed(evt);
//        
//        jButton1.setEnabled(true);
//        jButton2.setEnabled(true);
//        jButton3.setEnabled(true);
//        jButton4.setEnabled(true);
//        jButton5.setEnabled(true);
//        jButton6.setEnabled(true);
//        jTextField1.setEnabled(true);
    }
    
    private void jButtonRetireActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jButtonRetireActionPerformed
//        retirarse();
//        new Thread(() -> esperarFinRonda(evt)).start();
    }//GEN-LAST:event_jButtonRetireActionPerformed

    private void jMenuItemExitActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jMenuItemExitActionPerformed
//        Conexion.cerradoCabecerasConexion();
//        this.dispose();
    }//GEN-LAST:event_jMenuItemExitActionPerformed

    // Variables declaration - do not modify//GEN-BEGIN:variables
    private javax.swing.JButton jButton1;
    private javax.swing.JButton jButton2;
    private javax.swing.JButton jButton3;
    private javax.swing.JButton jButton4;
    private javax.swing.JButton jButtonBet;
    private javax.swing.JButton jButtonRetire;
    private javax.swing.JLabel jLabel11;
    private javax.swing.JLabel jLabel3;
    private javax.swing.JLabel jLabel5;
    private javax.swing.JLabel jLabel9;
    private javax.swing.JLabel jLabelCartaMesa1;
    private javax.swing.JLabel jLabelCartaMesa2;
    private javax.swing.JLabel jLabelCartaMesa3;
    private javax.swing.JLabel jLabelCartaMesa4;
    private javax.swing.JLabel jLabelCartaMesa5;
    private javax.swing.JLabel jLabelCartaPropia1;
    private javax.swing.JLabel jLabelCartaPropia2;
    private javax.swing.JLabel jLabelConnectionStatus;
    private javax.swing.JLabel jLabelIDPlayer;
    private javax.swing.JLabel jLabelOwnChips;
    private javax.swing.JLabel jLabelPlayerInfoTitle;
    private javax.swing.JLabel jLabelPoolComun;
    private javax.swing.JMenuBar jMenuBar1;
    private javax.swing.JMenuItem jMenuItemExit;
    private javax.swing.JMenuItem jMenuItemLeaveGame;
    private javax.swing.JMenu jMenuLeyend;
    private javax.swing.JMenu jMenuProperties;
    private javax.swing.JPanel jPanelPrincipal;
    private javax.swing.JTextField jTextFieldBetAmmount;
    // End of variables declaration//GEN-END:variables
}
